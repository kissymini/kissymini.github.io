<!DOCTYPE html>

<html>
<head>
  <title>node.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="anim.html">
                anim.js
              </a>
            
              
              <a class="source" href="core.html">
                core.js
              </a>
            
              
              <a class="source" href="event.html">
                event.js
              </a>
            
              
              <a class="source" href="io.html">
                io.js
              </a>
            
              
              <a class="source" href="loader.html">
                loader.js
              </a>
            
              
              <a class="source" href="node.html">
                node.js
              </a>
            
              
              <a class="source" href="ua.html">
                ua.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>node.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h3 id="api-delete">API Delete</h3>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <table>
<thead>
<tr>
<th style="text-align:left">API</th>
<th style="text-align:center">KISSY</th>
<th style="text-align:center">KISSY-MINI</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">test</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">replaceClass</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">style</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">innerWidth</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">innerHeight</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">outerWidth</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">outerHeight</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">addStyleSheet</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">docHeight</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">docWidth</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">viewportHeight</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">viewportWidth</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">scrollIntoView</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">unselectable</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">nodeName</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">outerHTML</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
</tbody>
</table>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h3 id="api-todo">API TODO</h3>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <table>
<thead>
<tr>
<th style="text-align:left">API</th>
<th style="text-align:center">KISSY</th>
<th style="text-align:center">KISSY-MINI</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">data</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">removeData</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
<tr>
<td style="text-align:left">hasData</td>
<td style="text-align:center">√</td>
<td style="text-align:center">╳</td>
</tr>
</tbody>
</table>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h3 id="kissy-vs-kissy-mini">KISSY VS KISSY-MINI</h3>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <table>
<thead>
<tr>
<th style="text-align:left">KISSY</th>
<th style="text-align:center">KISSY-MINI</th>
<th style="text-align:center">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">S.DOM.css(el, name)</td>
<td style="text-align:center">S.all(el).css(name)</td>
<td style="text-align:center">只支持链式写法</td>
</tr>
<tr>
<td style="text-align:left">S.DOM.parent(el, 2)</td>
<td style="text-align:center">╳</td>
<td style="text-align:center">不支持指定层级</td>
</tr>
<tr>
<td style="text-align:left">S.DOM.clone()</td>
<td style="text-align:center"></td>
<td style="text-align:center">只支持元素复制</td>
</tr>
</tbody>
</table>

            </div>
            
            <div class="content"><div class='highlight'><pre>
;(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(global, S)</span> </span>{

<span class="hljs-comment">/**
 * @ignore
 * @file util
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> win   = <span class="hljs-built_in">window</span>,
    doc   = <span class="hljs-built_in">document</span>,
    docEl = doc.documentElement;

<span class="hljs-keyword">var</span> emptyArray = [],
    some       = emptyArray.some,
    every      = emptyArray.every,
    slice      = emptyArray.slice,
    filter     = emptyArray.filter,
    concat     = emptyArray.concat,
    indexOf    = emptyArray.indexOf,
    forEach    = emptyArray.forEach;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mix</span><span class="hljs-params">(target, source)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> source) {
        target[key] = source[key];
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">map</span><span class="hljs-params">(els, cb)</span> </span>{
    <span class="hljs-keyword">var</span> val,
        ret = [];

    els &amp;&amp; forEach.call(els, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el, index)</span> </span>{
        val = cb(el, index);
        <span class="hljs-keyword">if</span> (val !== <span class="hljs-literal">null</span>) {
            ret.push(val);
        }
    });

    <span class="hljs-keyword">return</span> ret.length ? concat.apply([], ret) : ret;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">each</span><span class="hljs-params">(els, callback)</span> </span>{
    els &amp;&amp; forEach.call(els, callback);
    <span class="hljs-keyword">return</span> els;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isWindow</span><span class="hljs-params">(node)</span> </span>{
    <span class="hljs-keyword">return</span> node &amp;&amp; node == node.window;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isDocument</span><span class="hljs-params">(node)</span> </span>{
    <span class="hljs-keyword">return</span> node &amp;&amp; node.nodeType === <span class="hljs-number">9</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isElement</span><span class="hljs-params">(node)</span> </span>{
    <span class="hljs-keyword">return</span> node &amp;&amp; node.nodeType === <span class="hljs-number">1</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">likeArray</span><span class="hljs-params">(nodes)</span> </span>{
    <span class="hljs-keyword">return</span> nodes &amp;&amp; <span class="hljs-keyword">typeof</span> nodes.length == <span class="hljs-string">'number'</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unique</span><span class="hljs-params">(array)</span> </span>{
    <span class="hljs-keyword">return</span> filter.call(array, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item, index)</span> </span>{
        <span class="hljs-keyword">return</span> array.indexOf(item) == index;
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getScript</span><span class="hljs-params">(url)</span> </span>{
    <span class="hljs-keyword">var</span> script = doc.createElement(<span class="hljs-string">'script'</span>),
        head   = doc.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>] || docEl;

    script.src = url;
    head.insertBefore(script, head.firstChild);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isType</span><span class="hljs-params">(type)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> </span>{
        <span class="hljs-keyword">return</span> {}.toString.call(obj) == <span class="hljs-string">'[object '</span> + type + <span class="hljs-string">']'</span>;
    }
}

<span class="hljs-keyword">var</span> isNumber   = isType(<span class="hljs-string">'Number'</span>),
    isString   = isType(<span class="hljs-string">'String'</span>),
    isObject   = isType(<span class="hljs-string">'Object'</span>),
    isArray    = <span class="hljs-built_in">Array</span>.isArray || isType(<span class="hljs-string">'Array'</span>),
    isFunction = isType(<span class="hljs-string">'Function'</span>);

<span class="hljs-keyword">var</span> isPlainObject = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> </span>{
    <span class="hljs-keyword">return</span> isObject(obj) &amp;&amp; !isWindow(obj) &amp;&amp; <span class="hljs-built_in">Object</span>.getPrototypeOf(obj) == <span class="hljs-built_in">Object</span>.prototype;
};
<span class="hljs-comment">/**
 * @ignore
 * @file node
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> node = {};

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p><strong> .indexOf() </strong></p>
<ul>
<li><p>.indexOf(el)</p>
<p>逻辑类似 <code>Array.prototype.indexOf</code></p>
<p>查找 el 在 els（元素列表）中的位置，el 类型可以是 Node，也可以是原生节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    indexOf: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
        <span class="hljs-keyword">return</span> likeArray(el) ?
            indexOf.call(<span class="hljs-keyword">this</span>, el[<span class="hljs-number">0</span>]) :
            indexOf.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p><strong> .each() </strong></p>
<ul>
<li><p>.each(cb)</p>
<p>遍历数组中的每一项，执行指定方法，函数返回 false 则遍历结束</p>
<p>this 关键字指向当前 item（作为函数的第一个参数传递）</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    each: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(cb)</span> </span>{
        every.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el, index)</span> </span>{
            el = $(el);
            <span class="hljs-keyword">return</span> cb.call(el, el, index) !== <span class="hljs-literal">false</span>;
        });
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p><strong> .slice() </strong></p>
<ul>
<li><p>.slice(start[, end])</p>
<p>返回一个新的 Node 集合对象，提取包含从 start 到 end （不包括该元素）的元素</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    slice: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> $(slice.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p><strong> .end() </strong></p>
<ul>
<li><p>.end()</p>
<p>得到上一次 S.one() / S.all() 操作前的 Node 对象</p>
<p>引入该方法是为了更好的支持链式操作( chaining )</p>
<p>可以在一个语句内对不同层次得节点集合进行不同的操作</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    end: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.__parent || <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p><strong> .getDOMNode() </strong></p>
<ul>
<li><p>.getDOMNode()</p>
<p>得到该 Node 对象包含的第一个原生节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getDOMNode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]
    }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p><strong> .all() </strong></p>
<ul>
<li><p>.all(selector[, context])</p>
<p>通过执行 css 选择器包装 dom 节点，创建元素或者从一个 html 片段来创建一个 Node 对象</p>
<p>Node 集合是一个类似数组的对象，它具有链式方法来操作它指向的 dom ，文档对象中的所有方法都是集合方法</p>
<p>如果选择器中存在 content 参数（css 选择器，dom，或者 Node 集合对象），那么只在所给的节点背景下进行 css 选择器，这个功能有点像使用 <code>S.all(context).all(selector)</code></p>
<p>可以通过一个 html 字符串片段来创建一个 dom 节点。也可以通过给定一组属性映射来创建节点。最快的创建元素，使用 <code>&lt;div&gt;</code> 或 <code>&lt;div/&gt;</code> 形式</p>
</li>
</ul>
<pre><code><span class="hljs-keyword">var</span> $ = S.all;

$(<span class="hljs-string">'div'</span>);          <span class="hljs-comment">//=&gt; 获取所有 div 节点</span>
$(<span class="hljs-string">'#foo'</span>);         <span class="hljs-comment">//=&gt; 获取 ID 为 'foo' 的节点</span>
$(<span class="hljs-string">'&lt;p&gt;Hello&lt;/p&gt;'</span>); <span class="hljs-comment">//=&gt; 创建 p 节点</span>
$(<span class="hljs-string">'&lt;div /&gt;'</span>, {
    text: <span class="hljs-string">'ok'</span>,
    css : {
        color: <span class="hljs-string">'red'</span>
    }
}); <span class="hljs-comment">//=&gt; &lt;div style="color:red"&gt;ok&lt;/div&gt;</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> $ = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector, context)</span> </span>{
    <span class="hljs-keyword">var</span> ret = [];

    <span class="hljs-keyword">if</span> (selector) {
        <span class="hljs-keyword">if</span> (isString(selector)) {
            selector = selector.trim();

            <span class="hljs-keyword">if</span> (selector[<span class="hljs-number">0</span>] == <span class="hljs-string">'&lt;'</span> &amp;&amp; <span class="hljs-regexp">/&lt;([\w:]+)/</span>.test(selector)) {
                ret = node.create(selector);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (context !== <span class="hljs-literal">undefined</span>) {
                ret = find(selector, $(context));
            } <span class="hljs-keyword">else</span> {
                ret = query(selector, doc);
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($.isNode(selector)) {
            <span class="hljs-keyword">return</span> selector;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (selector.nodeType || selector.setTimeout) {
                ret = [selector];
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isArray(selector)) {
                ret = [];
                each(selector, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(s)</span> </span>{
                    ret.push($.isNode(s) ? s[<span class="hljs-number">0</span>] : s);
                });
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!selector.nodeType &amp;&amp; !selector.setTimeout &amp;&amp; selector.item) {
                ret = slice.call(selector);
            }
        }
    }

    <span class="hljs-keyword">return</span> $.node(ret);
};

$.all = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector, context)</span> </span>{
    <span class="hljs-keyword">return</span> $(selector, context);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p><strong> .one() </strong></p>
<ul>
<li><p>.one(selector[, context])</p>
<p>返回一个节点，用法同 <code>.all()</code></p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.one = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector, context)</span> </span>{
    <span class="hljs-keyword">return</span> $(selector, context).item(<span class="hljs-number">0</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p><strong> .node() </strong></p>
<ul>
<li><p>.node(els)</p>
<p>把一个节点（数组）转换为 Node（集合）对象</p>
</li>
</ul>
<p>这里 <code>$.node</code> 实际指的是 <code>S.Node.node</code>，Node 对象实例将会继承 <code>S.node</code> 里的方法</p>
<p><code>S.Node.node</code> 一般情况下可以使用 <code>S.all()</code> 来代替</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.node = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(els)</span> </span>{
    els = els || [];
    els.__proto__ = node;
    <span class="hljs-keyword">return</span> els;
};

$.node.prototype = node;</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p><strong> .isNode() </strong></p>
<ul>
<li><p>.isNode(obj)</p>
<p>判断一个变量是否为 Node 对象</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.isNode = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> </span>{
    <span class="hljs-keyword">return</span> obj <span class="hljs-keyword">instanceof</span> $.node;
};
<span class="hljs-comment">/**
 * @ignore
 * @file node-selector
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> tempParent = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'div'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p><strong> .find() </strong></p>
<ul>
<li><p>.find(selector, context)</p>
<p>内部方法，在 context 范围内查找节点（增强版）</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span><span class="hljs-params">(selector, context)</span> </span>{
    <span class="hljs-keyword">return</span> context.length === <span class="hljs-number">1</span> ?
        query(selector, context[<span class="hljs-number">0</span>]) :
        unique(
            map(context, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                <span class="hljs-keyword">return</span> query(selector, el);
            })
        );
}</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p><strong> .query() </strong></p>
<ul>
<li><p>.query(selector, context)</p>
<p>内部方法，在 context 范围内查找节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">query</span><span class="hljs-params">(selector, context)</span> </span>{
    <span class="hljs-keyword">var</span> s        = selector.charAt(<span class="hljs-number">0</span>), ret,
        maybeID  = s === <span class="hljs-string">'#'</span>,
        maybeCls = s === <span class="hljs-string">'.'</span>,
        nameOnly = maybeID || maybeCls ? selector.slice(<span class="hljs-number">1</span>) : selector,
        isSimple = <span class="hljs-regexp">/^[\w-]*$/</span>.test(nameOnly);

    context = context === <span class="hljs-literal">undefined</span> ? <span class="hljs-built_in">document</span> : context;

    <span class="hljs-keyword">return</span> $(
        isDocument(context) || isElement(context) ?
            isDocument(context) &amp;&amp; maybeID &amp;&amp; isSimple ?
                (ret = context.getElementById(nameOnly)) ? [ret] : [] :
                slice.call(
                    !maybeID &amp;&amp; isSimple ?
                        maybeCls ?
                            context.getElementsByClassName(nameOnly) :
                            context.getElementsByTagName(selector) :
                        context.querySelectorAll(selector)
                )
            : []
    );
}</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p><strong> .matches() </strong></p>
<ul>
<li><p>.matches(el, selector)</p>
<p>内部方法，选择器匹配加速</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">matches</span><span class="hljs-params">(el, selector)</span> </span>{
    <span class="hljs-keyword">if</span> (!el || !selector || !isElement(el)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">var</span> matchesSelector = el.webkitMatchesSelector ||
                          el.mozMatchesSelector ||
                          el.oMatchesSelector ||
                          el.matchesSelector;

    <span class="hljs-keyword">if</span> (matchesSelector) {
        <span class="hljs-keyword">return</span> matchesSelector.call(el, selector);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> parent    = el.parentNode,
            hasParent = !!parent,
            match;

        <span class="hljs-keyword">if</span> (!hasParent) {
            parent = tempParent;
            parent.appendChild(el);
        }

        match = ~query(selector, parent).indexOf(el);
        !hasParent &amp;&amp; parent.removeChild(el);

        <span class="hljs-keyword">return</span> match;
    }
}

mix(S, {
    query: query
});

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p><strong> .all() </strong></p>
<ul>
<li><p>.all(selector)</p>
<p>给 <code>S.node</code> 参元类挂载 <code>.all()</code> 方法，推荐直接使用 <code>S.all()</code></p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    all: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
            ret;

        ret = $(find(selector, self));
        ret.__parent = self;

        <span class="hljs-keyword">return</span> ret;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p><strong> .one() </strong></p>
<ul>
<li><p>.one(selector)</p>
<p>给 <code>S.node</code> 参元类挂载 <code>.one()</code> 方法，推荐直接使用 <code>S.one()</code></p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    one: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
            ret;

        ret = self.all(selector);
        ret = ret.length ? ret.slice(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) : <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">if</span> (ret) {
            ret.__parent = self;
        }

        <span class="hljs-keyword">return</span> ret;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p><strong> .filter() </strong></p>
<ul>
<li><p>.filter(selector)</p>
<p>给 <code>S.node</code> 参元类挂载 <code>.filter()</code> 方法，推荐直接使用 <code>els.filter()</code></p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    filter: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> </span>{
        <span class="hljs-keyword">if</span> (isFunction(selector)) {
            <span class="hljs-keyword">return</span> $(filter.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                <span class="hljs-keyword">return</span> selector.call(el, el);
            }));
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> $(filter.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                <span class="hljs-keyword">return</span> matches(el, selector);
            }));
        }
    }

});

<span class="hljs-comment">/**
 * @ignore
 * @file node-class
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> classCache = {};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classRE</span><span class="hljs-params">(name)</span> </span>{
    <span class="hljs-keyword">return</span> name <span class="hljs-keyword">in</span> classCache ?
        classCache[name] : (classCache[name] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'(^|\\s)'</span> + name + <span class="hljs-string">'(\\s|$)'</span>));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">className</span><span class="hljs-params">(el, val)</span> </span>{
    <span class="hljs-keyword">if</span> (val === <span class="hljs-literal">undefined</span>) {
        <span class="hljs-keyword">return</span> el.className;
    } <span class="hljs-keyword">else</span> {
        el.className = val;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classSplit</span><span class="hljs-params">(names)</span> </span>{
    <span class="hljs-keyword">return</span> names.split(<span class="hljs-regexp">/[\.\s]\s*\.?/</span>);
}

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p><strong> .addClass() </strong></p>
<ul>
<li><p>.addClass(names)</p>
<p>给符合选择器的所有元素添加指定 class</p>
<p>多个 class 类名通过空格分隔</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(names)</span> </span>{
        <span class="hljs-keyword">if</span> (!names) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">var</span> $el       = $(el),
                cls       = className(el),
                classList = [];

            each(classSplit(names), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
                !$el.hasClass(name) &amp;&amp; classList.push(name)
            });

            classList.length &amp;&amp; className(el, cls + (cls ? <span class="hljs-string">' '</span> : <span class="hljs-string">''</span>) + classList.join(<span class="hljs-string">' '</span>))
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p><strong> .removeClass() </strong></p>
<ul>
<li><p>.removeClass()</p>
<p>给符合选择器的所有元素移除所有 class</p>
</li>
<li><p>.removeClass(names)</p>
<p>给符合选择器的所有元素移除指定 class</p>
<p>多个 class 类名通过空格分隔</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(names)</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">if</span> (names === <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">return</span> className(el, <span class="hljs-string">''</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> classList = className(el);

                each(classSplit(names), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
                    classList = classList.replace(classRE(name), <span class="hljs-string">' '</span>);
                });

                className(el, classList.trim());
            }
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p><strong> .toggleClass() </strong></p>
<ul>
<li><p>.toggleClass(names[, when])</p>
<p>操作符合选择器的所有元素，如果存在值为 names 的 class，则移除掉，反之添加</p>
<p>如果 when 的值为真，这个功能类似于 <code>.addClass()</code> 方法，如果为假，这个功能类似与 <code>.removeClass()</code> 方法</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    toggleClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(names, when)</span> </span>{
        <span class="hljs-keyword">if</span> (!names) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">var</span> $el = $(el);

            each(classSplit(names), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
                (when === <span class="hljs-literal">undefined</span> ? !$el.hasClass(name) : when) ?
                    $el.addClass(name) : $el.removeClass(name);
            });
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p><strong> .hasClass() </strong></p>
<ul>
<li><p>.hasClass(names)</p>
<p>判断符合选择器的所有元素中是否有某个元素含有特定 class</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hasClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(names)</span> </span>{
        <span class="hljs-keyword">if</span> (!names) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> some.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">return</span> every.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
                <span class="hljs-keyword">return</span> name ? classRE(name).test(className(el)) : <span class="hljs-literal">true</span>;
            });
        }, classSplit(names));
    }

});

<span class="hljs-comment">/**
 * @ignore
 * @file node-attr
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> RE_BOOLEAN = <span class="hljs-regexp">/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i</span>;

<span class="hljs-keyword">var</span> attrMethod = [<span class="hljs-string">'val'</span>, <span class="hljs-string">'css'</span>, <span class="hljs-string">'html'</span>, <span class="hljs-string">'text'</span>, <span class="hljs-string">'data'</span>, <span class="hljs-string">'width'</span>, <span class="hljs-string">'height'</span>, <span class="hljs-string">'offset'</span>],
    propFixMap = {
        hidefocus      : <span class="hljs-string">'hideFocus'</span>,
        tabindex       : <span class="hljs-string">'tabIndex'</span>,
        readonly       : <span class="hljs-string">'readOnly'</span>,
        <span class="hljs-string">'for'</span>          : <span class="hljs-string">'htmlFor'</span>,
        <span class="hljs-string">'class'</span>        : <span class="hljs-string">'className'</span>,
        maxlength      : <span class="hljs-string">'maxLength'</span>,
        cellspacing    : <span class="hljs-string">'cellSpacing'</span>,
        cellpadding    : <span class="hljs-string">'cellPadding'</span>,
        rowspan        : <span class="hljs-string">'rowSpan'</span>,
        colspan        : <span class="hljs-string">'colSpan'</span>,
        usemap         : <span class="hljs-string">'useMap'</span>,
        frameborder    : <span class="hljs-string">'frameBorder'</span>,
        contenteditable: <span class="hljs-string">'contentEditable'</span>
    };

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pluck</span><span class="hljs-params">(els, property)</span> </span>{
    <span class="hljs-keyword">return</span> map(els, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
        <span class="hljs-keyword">return</span> el[property];
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setAttribute</span><span class="hljs-params">(el, name, val)</span> </span>{
    val == <span class="hljs-literal">null</span> ? el.removeAttribute(name) : el.setAttribute(name, val)
}

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p><strong> .attr() </strong></p>
<ul>
<li><p>.attr(name)</p>
<p>获取符合选择器的第一个元素的属性值</p>
</li>
<li><p>.attr(name, val)</p>
<p>给符合选择器的所有元素设置属性值</p>
</li>
<li><p>.attr(kv)</p>
<p>给符合选择器的所有元素设置属性值</p>
</li>
</ul>
<p><code>.attr()</code> 和 <code>.prop()</code> 的区别</p>
<pre><code>el.attr(<span class="hljs-string">'checked'</span>) <span class="hljs-comment">// =&gt; "checked"</span>
el.prop(<span class="hljs-string">'checked'</span>) <span class="hljs-comment">// =&gt; true</span>
</code></pre><p><code>.attr()</code> 和 <code>.prop()</code> 的使用</p>
<p>从中文意思看，两者分别是获取 / 设置 attributes 和 properties 的方法，分别在这两个场景中使用：具有 true 和 false 两个属性的属性，如 checked，selected 或者 disabled 使用 <code>.prop()</code>，其他的使用 <code>.attr()</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    attr: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, val)</span> </span>{
        <span class="hljs-keyword">var</span> key,
            ret;

        <span class="hljs-keyword">if</span> (isPlainObject(name)) {
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> name) {
                node.attr.call(<span class="hljs-keyword">this</span>, key, name[key]);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }

        <span class="hljs-keyword">if</span> (~attrMethod.indexOf(name)) {
            <span class="hljs-keyword">return</span> $(<span class="hljs-keyword">this</span>)[name](val);
        }

        <span class="hljs-keyword">if</span> (val == <span class="hljs-literal">undefined</span>) {
            <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

            <span class="hljs-keyword">if</span> (el &amp;&amp; isElement(el)) {
                <span class="hljs-keyword">if</span> (RE_BOOLEAN.test(name)) {
                    ret = $(el).prop(name) ? name.toLowerCase() : <span class="hljs-literal">undefined</span>;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name == <span class="hljs-string">'value'</span> &amp;&amp; el.nodeName == <span class="hljs-string">'INPUT'</span>) {
                    ret = <span class="hljs-keyword">this</span>.val();
                } <span class="hljs-keyword">else</span> {
                    ret = el.getAttribute(name);
                    ret = !ret &amp;&amp; name <span class="hljs-keyword">in</span> el ? el[name] : ret;
                }
            }
        } <span class="hljs-keyword">else</span> {
            ret = each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                isElement(el) &amp;&amp; setAttribute(el, name, val);
            });
        }

        <span class="hljs-keyword">return</span> ret === <span class="hljs-literal">null</span> ? <span class="hljs-literal">undefined</span> : ret;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p><strong> .removeAttr() </strong></p>
<ul>
<li><p>.removeAttr(name)</p>
<p>移除符合选择器的所有元素的指定属性</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeAttr: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            isElement(el) &amp;&amp; setAttribute(el, name)
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p><strong> .hasAttr() </strong></p>
<ul>
<li><p>.hasAttr(name)</p>
<p>判断符合选择器的所有元素中是否有某个元素含有特定属性</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hasAttr: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
        <span class="hljs-keyword">if</span> (!name) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">return</span> some.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">return</span> isElement(el) &amp;&amp; el.getAttribute(name);
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p><strong> .prop() </strong></p>
<ul>
<li><p>.prop(name)</p>
<p>获取符合选择器的第一个元素的对应 property 值</p>
</li>
<li><p>.prop(name, val)</p>
<p>给符合选择器的所有元素设置 property 值</p>
</li>
<li><p>.prop(kv)</p>
<p>给符合选择器的所有元素设置 property 值</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    prop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, val)</span> </span>{
        name = propFixMap[name] || name;
        <span class="hljs-keyword">return</span> val == <span class="hljs-literal">undefined</span> ?
            <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>][name] :
            each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                el[name] = val;
            });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p><strong> .hasProp() </strong></p>
<ul>
<li><p>.hasProp(name)</p>
<p>判断符合选择器的第一个元素是否含有特定 property 属性</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hasProp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
        <span class="hljs-keyword">if</span> (!name) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        name = propFixMap[name] || name;
        <span class="hljs-keyword">return</span> some.call(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">return</span> isElement(el) &amp;&amp; el[name];
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p><strong> .val() </strong></p>
<ul>
<li><p>.val()</p>
<p>获取符合选择器的第一个元素所的 value 值</p>
</li>
<li><p>.val(val)</p>
<p>给符合选择器的所有元素设置 value 值</p>
</li>
</ul>
<p>如果是 <code>&lt;select multiple&gt;</code> 标签，则返回一个数组</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    val: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val)</span> </span>{
        <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">if</span> (!el) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;

        <span class="hljs-keyword">if</span> (el.multiple) {
            <span class="hljs-keyword">var</span> opts = $(<span class="hljs-string">'option'</span>, el);

            <span class="hljs-keyword">return</span> val == <span class="hljs-literal">undefined</span> ?
                slice.call(
                    pluck(
                        opts.filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(opt)</span> </span>{
                            <span class="hljs-keyword">return</span> opt.selected;
                        }), <span class="hljs-string">'value'</span>
                    )
                ) :
                each(opts, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(opt)</span> </span>{
                    opt.selected = ~val.indexOf(opt.value);
                });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> val == <span class="hljs-literal">undefined</span> ?
                el.value :
                each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                    el.value = val;
                });
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p><strong> .text() </strong></p>
<ul>
<li><p>.text()</p>
<p>获取符合选择器的第一个元素所包含的文本值</p>
</li>
<li><p>.val(text)</p>
<p>给符合选择器的所有元素设置文本值</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    text: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(text)</span> </span>{
        <span class="hljs-keyword">return</span> text === <span class="hljs-literal">undefined</span> ?
            <span class="hljs-keyword">this</span>.length ?
                <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].textContent : <span class="hljs-literal">null</span>
            :
            each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                el.textContent = (text === <span class="hljs-literal">undefined</span>) ? <span class="hljs-string">''</span> : <span class="hljs-string">''</span> + text
            });
    }

});

<span class="hljs-comment">/**
 * @ignore
 * @file node-style
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> cssNumber = {
        <span class="hljs-string">'column-count'</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">'columns'</span>     : <span class="hljs-number">1</span>,
        <span class="hljs-string">'font-weight'</span> : <span class="hljs-number">1</span>,
        <span class="hljs-string">'line-height'</span> : <span class="hljs-number">1</span>,
        <span class="hljs-string">'opacity'</span>     : <span class="hljs-number">1</span>,
        <span class="hljs-string">'z-index'</span>     : <span class="hljs-number">1</span>,
        <span class="hljs-string">'zoom'</span>        : <span class="hljs-number">1</span>
    },
    elDisplay = {};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dasherize</span><span class="hljs-params">(str)</span> </span>{
    <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/::/g</span>, <span class="hljs-string">'/'</span>)
              .replace(<span class="hljs-regexp">/([A-Z]+)([A-Z][a-z])/g</span>, <span class="hljs-string">'$1_$2'</span>)
              .replace(<span class="hljs-regexp">/([a-z\d])([A-Z])/g</span>, <span class="hljs-string">'$1_$2'</span>)
              .replace(<span class="hljs-regexp">/_/g</span>, <span class="hljs-string">'-'</span>)
              .toLowerCase();
}</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p><strong> .camelCase() </strong></p>
<ul>
<li><p>.camelCase(name)</p>
<p>内部方法，将一组字符串变成“骆驼”命名法的新字符串，如果该字符已经是“骆驼”命名法，则不变化</p>
</li>
</ul>
<pre><code>.camelCase(<span class="hljs-string">'abc-def'</span>); <span class="hljs-comment">//=&gt; 'abcDef'</span>
.camelCase(<span class="hljs-string">'abcDef'</span>);  <span class="hljs-comment">//=&gt; 'abcDef'</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">camelCase</span><span class="hljs-params">(name)</span> </span>{
    <span class="hljs-keyword">return</span> name.replace(<span class="hljs-regexp">/-+(.)?/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>].toUpperCase();
    });
}</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p><strong> .maybeAddPx() </strong></p>
<ul>
<li><p>.maybeAddPx(name, val)</p>
<p>内部方法，根据情况将数字转换为带单位的值</p>
</li>
</ul>
<pre><code>.maybeAddPx(<span class="hljs-string">'width'</span>, <span class="hljs-number">12</span>); <span class="hljs-comment">//=&gt; '12px'</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">maybeAddPx</span><span class="hljs-params">(name, val)</span> </span>{
    <span class="hljs-keyword">return</span> isNumber(val) &amp;&amp; !cssNumber[dasherize(name)] ? val + <span class="hljs-string">'px'</span> : val;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p><strong> .getComputedStyle() </strong></p>
<ul>
<li><p>.getComputedStyle(el, name)</p>
<p>内部方法，获取元素所有最终使用的 CSS 属性值</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getComputedStyle</span><span class="hljs-params">(el, name)</span> </span>{
    <span class="hljs-keyword">return</span> win.getComputedStyle(el, <span class="hljs-literal">null</span>).getPropertyValue(name);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p><strong> .getDefaultDisplay() </strong></p>
<ul>
<li><p>.getDefaultDisplay(tagName)</p>
<p>内部方法，获取 tag 元素原始 display 属性</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDefaultDisplay</span><span class="hljs-params">(tagName)</span> </span>{
    <span class="hljs-keyword">if</span> (!elDisplay[tagName]) {
        <span class="hljs-keyword">var</span> el = doc.createElement(tagName),
            display;

        doc.body.appendChild(el);
        display = getComputedStyle(el, <span class="hljs-string">'display'</span>);
        el.parentNode.removeChild(el);
        display == <span class="hljs-string">'none'</span> &amp;&amp; (display = <span class="hljs-string">'block'</span>);
        elDisplay[tagName] = display;
    }

    <span class="hljs-keyword">return</span> elDisplay[tagName];
}

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p><strong> .css() </strong></p>
<ul>
<li><p>.css(name)</p>
<p>获取符合选择器的第一个元素的样式值</p>
</li>
<li><p>.css(name, val)</p>
<p>给符合选择器的所有元素设置样式值</p>
</li>
<li><p>.css(kv)</p>
<p>给符合选择器的所有元素设置样式值</p>
</li>
</ul>
<pre><code><span class="hljs-keyword">var</span> el = $(<span class="hljs-string">'h1'</span>);
el.css(<span class="hljs-string">'background-color'</span>);         <span class="hljs-comment">// 获取属性</span>
el.css(<span class="hljs-string">'background-color'</span>, <span class="hljs-string">'#369'</span>); <span class="hljs-comment">// 设置属性</span>
el.css(<span class="hljs-string">'background-color'</span>, <span class="hljs-string">''</span>);     <span class="hljs-comment">// 删除属性</span>
<span class="hljs-comment">// 设置多个属性</span>
el.css({
    fontSize       : <span class="hljs-number">28</span>,
    backgroundColor: <span class="hljs-string">'#8EE'</span>
});
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    css: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, val)</span> </span>{
        <span class="hljs-keyword">var</span> key,
            ret = <span class="hljs-string">''</span>;

        <span class="hljs-keyword">if</span> (val == <span class="hljs-literal">undefined</span>) {
            <span class="hljs-keyword">if</span> (isString(name)) {
                <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

                <span class="hljs-keyword">return</span> el ? el.style[camelCase(name)] || getComputedStyle(el, name) : <span class="hljs-string">''</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isObject(name)) {
                <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> name) {
                    ret += dasherize(key) + <span class="hljs-string">':'</span> + maybeAddPx(key, name[key]) + <span class="hljs-string">';'</span>;
                }
            }
        } <span class="hljs-keyword">else</span> {
            ret = dasherize(name) + <span class="hljs-string">':'</span> + maybeAddPx(name, val) + <span class="hljs-string">';'</span>;
        }

        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            el.style.cssText += <span class="hljs-string">';'</span> + ret;
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p><strong> .show() </strong></p>
<ul>
<li><p>.show()</p>
<p>显示符合选择器的所有元素</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    show: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            el.style.display == <span class="hljs-string">'none'</span> &amp;&amp; (el.style.display = <span class="hljs-string">''</span>);
            <span class="hljs-keyword">if</span> (getComputedStyle(el, <span class="hljs-string">'display'</span>) == <span class="hljs-string">'none'</span>) {
                el.style.display = getDefaultDisplay(el.nodeName);
            }
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p><strong> .hide() </strong></p>
<ul>
<li><p>.hide()</p>
<p>隐藏符合选择器的所有元素</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hide: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.css(<span class="hljs-string">'display'</span>, <span class="hljs-string">'none'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p><strong> .toggle() </strong></p>
<ul>
<li><p>.toggle()</p>
<p>将符合选择器的所有元素切换显示/隐藏两个状态</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    toggle: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">var</span> $el = $(el);

            $el.css(<span class="hljs-string">'display'</span>) == <span class="hljs-string">'none'</span> ? $el.show() : $el.hide();
        });
    }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p><strong> .width() </strong></p>
<ul>
<li><p>.width()</p>
<p>获取符合选择器的第一个元素的宽度值</p>
</li>
<li><p>.width(val)</p>
<p>给符合选择器的所有元素设置宽度值</p>
</li>
</ul>
<p><code>.width()</code> 和 <code>.css(&#39;width&#39;)</code> 的区别</p>
<p><code>.width()</code> 返回不带单位的纯数值，<code>.css(&#39;width&#39;)</code> 返回带单位的原始值（例如：400px），当需要数值计算时, 推荐该方法.</p>
<p>获取 <code>window</code> 和 <code>document</code> 的宽度</p>
<pre><code><span class="hljs-comment">// 获取当前可视区域的宽度值, 相当于 viewportWidth</span>
S.all(<span class="hljs-built_in">window</span>).width();

<span class="hljs-comment">// 获取页面文档 document 的总宽度, 相当于 docWidth</span>
S.all(<span class="hljs-built_in">document</span>).width();
</code></pre><p><strong> .height() </strong></p>
<ul>
<li><p>.height()</p>
<p>获取符合选择器的第一个元素的高度值</p>
</li>
<li><p>.height(val)</p>
<p>给符合选择器的所有元素设置高度值</p>
</li>
</ul>
<p>获取 <code>window</code> 和 <code>document</code> 的高度</p>
<pre><code><span class="hljs-comment">// 获取当前可视区域的高度值, 相当于 viewportHeight</span>
S.all(<span class="hljs-built_in">window</span>).height();

<span class="hljs-comment">// 获取页面文档 document 的总高度, 相当于 docHeight</span>
S.all(<span class="hljs-built_in">document</span>).height();
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>each([<span class="hljs-string">'width'</span>, <span class="hljs-string">'height'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method)</span> </span>{
    node[method] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val)</span> </span>{
        <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">if</span> (val) {
            <span class="hljs-keyword">return</span> $(<span class="hljs-keyword">this</span>).css(method, val);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> isWindow(el) ? el[camelCase(<span class="hljs-string">'inner-'</span> + method)] :
                isDocument(el) ? docEl[camelCase(<span class="hljs-string">'scroll-'</span> + method)] :
                    <span class="hljs-keyword">this</span>.offset()[method];
        }
    };
});

<span class="hljs-comment">/**
 * @ignore
 * @file node-traversal
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filtered</span><span class="hljs-params">(els, selector)</span> </span>{
    <span class="hljs-keyword">var</span> $els = $(els);

    <span class="hljs-keyword">return</span> selector !== <span class="hljs-literal">undefined</span> ?
        $els.filter(
            isArray(selector) ?
                <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                    <span class="hljs-keyword">return</span> some.call(selector, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filter)</span> </span>{
                        <span class="hljs-keyword">return</span> matches(el, filter);
                    });
                } :
                selector
        ) :
        $els;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">children</span><span class="hljs-params">(el)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'children'</span> <span class="hljs-keyword">in</span> el ?
        slice.call(el.children) :
        map(el.childNodes, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">if</span> (isElement(el)) {
                <span class="hljs-keyword">return</span> el;
            }
        });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nth</span><span class="hljs-params">(el, filter, property, includeSelf)</span> </span>{
    <span class="hljs-keyword">var</span> ret   = [],
        array = isArray(filter);

    el = includeSelf ? el : el[property];

    <span class="hljs-keyword">while</span> (el) {
        <span class="hljs-keyword">if</span> (el &amp;&amp; !isDocument(el) &amp;&amp; isElement(el) &amp;&amp; ret.indexOf(el) &lt; <span class="hljs-number">0</span>) {
            ret.push(el);
        }
        el = el[property];
    }

    <span class="hljs-keyword">if</span> (array &amp;&amp; !filter.length) {
        filter = <span class="hljs-literal">undefined</span>
    }

    ret = filtered(ret, filter);

    <span class="hljs-keyword">return</span> array ?
        ret :
        ret.item(<span class="hljs-number">0</span>);
}

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p><strong> .item() </strong></p>
<ul>
<li><p>.item(index)</p>
<p>获取包含当前节点列表 index 位置处的单个原生节点的新 NodeList 对象</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    item: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(index)</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

        <span class="hljs-keyword">return</span> isNumber(index) ?
            index &gt;= self.length ?
                <span class="hljs-literal">null</span> :
                $(self[index]) :
            $(index);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p><strong> .first() </strong></p>
<ul>
<li><p>.first([filter])</p>
<p>获取符合选择器的第一个元素的第一个子节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    first: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filter)</span> </span>{
        <span class="hljs-keyword">return</span> nth(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].firstChild, filter, <span class="hljs-string">'nextElementSibling'</span>, <span class="hljs-literal">true</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p><strong> .last() </strong></p>
<ul>
<li><p>.last([filter])</p>
<p>获取符合选择器的第一个元素的最后一个子节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    last: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filter)</span> </span>{
        <span class="hljs-keyword">return</span> nth(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] &amp;&amp; <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].lastChild, filter, <span class="hljs-string">'previousElementSibling'</span>, <span class="hljs-literal">true</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p><strong> .next() </strong></p>
<ul>
<li><p>.next([filter])</p>
<p>获取符合选择器的第一个元素的下一个同级节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    next: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filter)</span> </span>{
        <span class="hljs-keyword">return</span> nth(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>], filter, <span class="hljs-string">'nextElementSibling'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p><strong> .prev() </strong></p>
<ul>
<li><p>.prev([filter])</p>
<p>获取符合选择器的第一个元素的上一个同级节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    prev: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filter)</span> </span>{
        <span class="hljs-keyword">return</span> nth(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>], filter, <span class="hljs-string">'previousElementSibling'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p><strong> .parent() </strong></p>
<ul>
<li><p>.parent([filter])</p>
<p>获取符合选择器的第一个元素的祖先元素</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    parent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filter)</span> </span>{
        <span class="hljs-keyword">return</span> nth(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>], filter, <span class="hljs-string">'parentNode'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p><strong> .children() </strong></p>
<ul>
<li><p>.children([filter])</p>
<p>获取符合选择器的所有非文字节点的子节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    children: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> </span>{
        <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">return</span> el ?
            filtered(children(el), selector) :
            <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p><strong> .siblings() </strong></p>
<ul>
<li><p>.siblings([filter])</p>
<p>获取符合选择器的第一个元素的相应同级节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    siblings: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> </span>{
        <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">return</span> el ?
            filtered(
                filter.call(children(el.parentNode), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(child)</span> </span>{
                    <span class="hljs-keyword">return</span> child !== el;
                })
            , selector) :
            <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p><strong> .contents() </strong></p>
<ul>
<li><p>.contents()</p>
<p>获取符合选择器的所有子节点（包括文字节点）</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    contents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">return</span> el ?
            $(slice.call(el.childNodes)) :
            <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p><strong> .contains() </strong></p>
<ul>
<li><p>.contains(contained)</p>
<p>判断某一容器（container）是否包含另一（contained）节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    contains: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(contained)</span> </span>{
        <span class="hljs-keyword">var</span> container = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>],
            contained = likeArray(contained) ? contained[<span class="hljs-number">0</span>] : contained;

        <span class="hljs-keyword">return</span> container &amp;&amp; contained ?
            container !== contained &amp;&amp; container.contains(contained) :
            <span class="hljs-literal">false</span>;
    }

});

<span class="hljs-comment">/**
 * @ignore
 * @file node-insertion
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p><strong> .filterScripts() </strong></p>
<ul>
<li><p>.filterScripts(nodes, scripts)</p>
<p>内部方法，将 nodes 中的脚本节点过滤掉</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterScripts</span><span class="hljs-params">(nodes, scripts)</span> </span>{
    <span class="hljs-keyword">var</span> ret = [];

    each(nodes, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(node)</span> </span>{
        <span class="hljs-keyword">var</span> name = node.nodeName,
            type = node.type,
            temp = [];

        <span class="hljs-keyword">if</span> (name &amp;&amp; name === <span class="hljs-string">'SCRIPT'</span> &amp;&amp; (!type || type === <span class="hljs-string">'text/javascript'</span>)) {
            node.parentNode &amp;&amp; node.parentNode.removeChild(node);
            scripts &amp;&amp; scripts.push(node);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (isElement(node)) {
                each(node.getElementsByTagName(<span class="hljs-string">'script'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                    temp.push(el);
                });
                filterScripts(temp, scripts);
            }
            ret.push(node);
        }
    });

    <span class="hljs-keyword">return</span> ret;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p><strong> .nodeListToFragment() </strong></p>
<ul>
<li><p>.nodeListToFragment(nodes)</p>
<p>内部方法，将 nodes 转换为文档片段，不会被添加到文档树中</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nodeListToFragment</span><span class="hljs-params">(nodes)</span> </span>{
    <span class="hljs-keyword">var</span> ret = <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">if</span> (nodes &amp;&amp; likeArray(nodes)) {
        ret = doc.createDocumentFragment();

        each(nodes, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(node)</span> </span>{
            ret.appendChild(node);
        });
    }

    <span class="hljs-keyword">return</span> ret;
}

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p><strong> .wrapAll() </strong></p>
<ul>
<li><p>.wrapAll(wrapperNode)</p>
<p>在所有匹配元素外面包一层 HTML 结构</p>
</li>
</ul>
<pre><code>&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"container"</span>&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

S.all('.inner').wrapAll('<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span> /&gt;</span>'); //=&gt;

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    wrapAll: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(wrapperNode)</span> </span>{
        <span class="hljs-keyword">var</span> el = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">if</span> (el) {
            <span class="hljs-keyword">var</span> $wrapperNode = $(wrapperNode),
                $wrapperChildren;

            $wrapperNode.insertBefore(el);

            <span class="hljs-keyword">while</span> (($wrapperChildren = $wrapperNode.children()).length) {
                $wrapperNode = $wrapperNode.first();
            }

            $wrapperNode.append(<span class="hljs-keyword">this</span>);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p><strong> .wrap() </strong></p>
<ul>
<li><p>.wrap(wrapperNode)</p>
<p>在每个匹配的元素外层包上一个 HTML 元素</p>
</li>
</ul>
<pre><code>&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"container"</span>&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

S.all('.inner').wrap('<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span> /&gt;</span>'); //=&gt;

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    wrap: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(wrapperNode)</span> </span>{
        <span class="hljs-keyword">var</span> $wrapperNode = $(wrapperNode),
            wrapperClone = $wrapperNode[<span class="hljs-number">0</span>].parentNode || <span class="hljs-keyword">this</span>.length;

        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            $(el).wrapAll(
                wrapperClone ? $wrapperNode[<span class="hljs-number">0</span>].cloneNode(<span class="hljs-literal">true</span>) : $wrapperNode[<span class="hljs-number">0</span>]
            );
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p><strong> .unwrap() </strong></p>
<ul>
<li><p>.unwrap()</p>
<p>移除集合中每个元素的直接父节点，并把他们的子元素保留在原来的位置</p>
</li>
</ul>
<pre><code>&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"container"</span>&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

S.all('.inner').unwrap(); //=&gt;

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    unwrap: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">var</span> $el     = $(el),
                $parent = $el.parent();

            $parent.replaceWith($parent.children());
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p><strong> .wrapInner() </strong></p>
<ul>
<li><p>.wrapInner(wrapperNode)</p>
<p>将每个元素中的内容包裹在一个单独的结构中</p>
</li>
</ul>
<pre><code>&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"container"</span>&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

S.all('.inner').wrapInner('<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span> /&gt;</span>'); //=&gt;

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"inner"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"new"</span>&gt;</span>Goodbye<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    wrapInner: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(wrapperNode)</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            <span class="hljs-keyword">var</span> $el       = $(el),
                $children = $el.children();

            <span class="hljs-keyword">if</span> ($children.length) {
                $children.wrapAll(wrapperNode);
            } <span class="hljs-keyword">else</span> {
                $el.append(wrapperNode);
            }
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p><strong> .replaceWith() </strong></p>
<ul>
<li><p>.replaceWith(newNodes)</p>
<p>用给定的内容替换所有匹配的元素</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    replaceWith: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(newNodes)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.before(newNodes).remove();
    }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p><strong> .after() </strong></p>
<ul>
<li><p>.after(html)</p>
<p>在匹配元素集合中的每个元素后面插入内容，作为其兄弟节点</p>
<p>内容可以为 HTML字符串，DOM 元素，DOM元素数组</p>
</li>
</ul>
<p><strong> .prepend() </strong></p>
<ul>
<li><p>.prepend(html)</p>
<p>将内容插入到每个匹配元素的前面（元素内部）</p>
<p>内容可以为 HTML字符串，DOM 元素，DOM元素数组</p>
</li>
</ul>
<p><strong> .before() </strong></p>
<ul>
<li><p>.before(html)</p>
<p>在匹配元素的前面（元素外部）插入内容</p>
<p>内容可以为 HTML字符串，DOM 元素，DOM元素数组</p>
</li>
</ul>
<p><strong> .append() </strong></p>
<ul>
<li><p>.append(html)</p>
<p>在每个匹配元素里面的末尾处插入内容</p>
<p>内容可以为 HTML字符串，DOM 元素，DOM元素数组，包含DOM元素的数组，包含Node元素的数组</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
each([<span class="hljs-string">'after'</span>, <span class="hljs-string">'prepend'</span>, <span class="hljs-string">'before'</span>, <span class="hljs-string">'append'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, index)</span> </span>{
    <span class="hljs-keyword">var</span> inside = index % <span class="hljs-number">2</span>;

    node[method] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(html)</span> </span>{
        <span class="hljs-keyword">var</span> nodes  = $.isNode(html) ? html : (isArray(html) ? $.all(html) : node.create(html + <span class="hljs-string">''</span>)),
            isCopy = <span class="hljs-keyword">this</span>.length &gt; <span class="hljs-number">1</span>,
            scripts = [],
            parent,
            target;

        <span class="hljs-keyword">if</span> (nodes.length) {
            nodes = nodeListToFragment(filterScripts(nodes, scripts));
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }

        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            parent = inside ? el : el.parentNode;

            <span class="hljs-keyword">switch</span> (index) {
                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
                    target = el.nextSibling;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
                    target = el.firstChild;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
                    target = el;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>:
                    target = <span class="hljs-literal">null</span>;
            }

            parent.insertBefore(isCopy ? nodes.cloneNode(<span class="hljs-literal">true</span>) : nodes, target);

            each(scripts, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                <span class="hljs-keyword">if</span> (el.src) {
                    getScript(el.src);
                } <span class="hljs-keyword">else</span> {
                    win[<span class="hljs-string">'eval'</span>].call(win, el.innerHTML);
                }
            });
        });
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p><strong> .insertAfter() </strong></p>
<ul>
<li><p>.insertAfter(target)</p>
<p>将集合中的元素插入到指定的目标元素后面（外部插入）</p>
</li>
</ul>
<p><strong> .prependTo() </strong></p>
<ul>
<li><p>.prependTo(target)</p>
<p>将所有元素插入到目标前面（内部插入）</p>
</li>
</ul>
<p><strong> .insertBefore() </strong></p>
<ul>
<li><p>.insertBefore(target)</p>
<p>将集合中的元素插入到指定的目标元素前面（外部插入）</p>
</li>
</ul>
<p><strong> .appendTo() </strong></p>
<ul>
<li><p>.appendTo(target)</p>
<p>将匹配的元素插入到目标元素的末尾（内部插入）</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    node[inside ? method + <span class="hljs-string">'To'</span> : <span class="hljs-string">'insert'</span> + (index ? <span class="hljs-string">'Before'</span> : <span class="hljs-string">'After'</span>)] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(target)</span> </span>{
        $(target)[method](<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };
});

<span class="hljs-comment">/**
 * @ignore
 * @file node-offset
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p><strong> .offset() </strong></p>
<ul>
<li><p>.offset()</p>
<p>获取符合选择器的第一个元素相对页面文档左上角的偏移值</p>
</li>
<li><p>.offset(coordinates)</p>
<p>给符合选择器的所有元素设置偏移值</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    offset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(coordinates)</span> </span>{
        <span class="hljs-keyword">var</span> ret;

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.length) {
            <span class="hljs-keyword">if</span> (coordinates === <span class="hljs-literal">undefined</span>) {
                <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].getBoundingClientRect();

                ret = {
                    left  : obj.left + win.pageXOffset,
                    top   : obj.top  + win.pageYOffset,
                    width : <span class="hljs-built_in">Math</span>.round(obj.width),
                    height: <span class="hljs-built_in">Math</span>.round(obj.height)
                }
            } <span class="hljs-keyword">else</span> {
                each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                    <span class="hljs-keyword">var</span> ret = {},
                        $el = $(el),
                        old = $el.offset(),
                        key,
                        current;

                    <span class="hljs-keyword">if</span> ($el.css(<span class="hljs-string">'position'</span>) === <span class="hljs-string">'static'</span>) {
                        $el.css(<span class="hljs-string">'position'</span>, <span class="hljs-string">'relative'</span>);
                    }

                    <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> coordinates) {
                        current  = <span class="hljs-built_in">parseFloat</span>($el.css(key)) || <span class="hljs-number">0</span>;
                        ret[key] = current + coordinates[key] - old[key];
                    }

                    $el.css(ret);
                });

                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
            }
        }

        <span class="hljs-keyword">return</span> ret;
    }

});</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p><strong> .scrollTop() </strong></p>
<ul>
<li><p>.scrollTop()</p>
<p>获取窗口或元素的 scrollTop 值</p>
</li>
<li><p>.scrollTop(val)</p>
<p>设置窗口或元素的 scrollTop 值</p>
</li>
</ul>
<p><strong> .scrollLeft() </strong></p>
<ul>
<li><p>.scrollLeft()</p>
<p>获取窗口或元素的 scrollLeft 值</p>
</li>
<li><p>.scrollLeft(val)</p>
<p>设置窗口或元素的 scrollLeft 值</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>each([<span class="hljs-string">'scrollTop'</span>, <span class="hljs-string">'scrollLeft'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, index)</span> </span>{

    node[method] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val)</span> </span>{
        <span class="hljs-keyword">var</span> el        = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>],
            hasScroll = method <span class="hljs-keyword">in</span> el;

        <span class="hljs-keyword">return</span> val === <span class="hljs-literal">undefined</span> ?
            hasScroll ?
                el[method] :
                el[<span class="hljs-string">'page'</span> + (index ? <span class="hljs-string">'X'</span> : <span class="hljs-string">'Y'</span>) + <span class="hljs-string">'Offset'</span>]
            :
            hasScroll ?
                each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                    el[method] = val;
                }) :
                each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                    <span class="hljs-keyword">if</span> (index) {
                        el.scrollTo(val, el.scrollY);
                    } <span class="hljs-keyword">else</span> {
                        el.scrollTo(el.scrollX, val);
                    }
                });
    }

});

<span class="hljs-comment">/**
 * @ignore
 * @file node-create
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span>

<span class="hljs-keyword">var</span> RE_TAG        = <span class="hljs-regexp">/&lt;([\w:]+)/</span>,
    RE_XHTML_TAG  = <span class="hljs-regexp">/&lt;(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^&gt;]*)\/&gt;/ig</span>,
    RE_SINGLE_TAG = <span class="hljs-regexp">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;)?$/</span>;

<span class="hljs-keyword">var</span> div        = doc.createElement(<span class="hljs-string">'div'</span>),
    table      = doc.createElement(<span class="hljs-string">'table'</span>),
    tableBody  = doc.createElement(<span class="hljs-string">'tbody'</span>),
    tableRow   = doc.createElement(<span class="hljs-string">'tr'</span>),
    containers = {
        <span class="hljs-string">'*'</span>  : div,
        thead: table,
        tbody: table,
        tfoot: table,
        tr   : tableBody,
        th   : tableRow,
        td   : tableRow
    };

mix(node, {</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p><strong> .create() </strong></p>
<ul>
<li><p>.create(html, props)</p>
<p>创建 dom 节点</p>
</li>
</ul>
<pre><code>S.node.create(<span class="hljs-string">'&lt;div&gt;'</span>)
S.node.create(<span class="hljs-string">'&lt;div /&gt;'</span>)
S.node.create(<span class="hljs-string">'&lt;div&gt;&lt;/div&gt;'</span>) <span class="hljs-comment">//=&gt; 创建 DIV 节点</span>
</code></pre><pre><code>S.node.create(<span class="hljs-string">'&lt;div&gt;&lt;/div&gt;'</span>, {
    text: <span class="hljs-string">'ok'</span>,
    css : {color: <span class="hljs-string">'red'</span>}
}); <span class="hljs-comment">//=&gt; 创建 DIV 节点，内容为'ok'，颜色为红色</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    create: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(html, props)</span> </span>{
        <span class="hljs-keyword">var</span> key,
            ret = [],
            tag,
            container;

        <span class="hljs-keyword">if</span> (!html || !isString(html)) {
            <span class="hljs-keyword">return</span> ret;
        }

        <span class="hljs-keyword">if</span> (RE_SINGLE_TAG.test(html)) {
            ret = $(doc.createElement(<span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span>));
        } <span class="hljs-keyword">else</span> {
            html = html.replace(RE_XHTML_TAG, <span class="hljs-string">'&lt;$1&gt;&lt;/$2&gt;'</span>);
            tag  = RE_TAG.test(html) &amp;&amp; <span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span>;

            container = containers[tag] || containers[<span class="hljs-string">'*'</span>];
            container.innerHTML = html;

            ret = each(slice.call(container.childNodes), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                container.removeChild(el);
            });
        }

        <span class="hljs-keyword">if</span> (isPlainObject(props)) {
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> props) {
                ret.attr(key, props[key]);
            }
        }

        <span class="hljs-keyword">return</span> ret;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p><strong> .html() </strong></p>
<ul>
<li><p>.html()</p>
<p>获取符合选择器的第一个元素的 innerHTML</p>
</li>
<li><p>.html(html[, loadScripts])</p>
<p>给符合选择器的所有元素设置 innerHTML 值</p>
<p>loadScripts 表示是否执行 html 中的内嵌脚本，默认 false</p>
</li>
</ul>
<pre><code><span class="hljs-keyword">var</span> el   = S.node.create(<span class="hljs-string">'&lt;div id="J_check"&gt;&lt;/div&gt;'</span>);
<span class="hljs-keyword">var</span> html = [
    <span class="hljs-string">'&lt;h3&gt;This is the added part&lt;/h3&gt;'</span>,
    <span class="hljs-string">'&lt;script&gt;alert(1)&lt;/script&gt;'</span>
].join(<span class="hljs-string">''</span>);
el.html(html);
<span class="hljs-comment">//=&gt; 不会 alert(1)</span>
el.html();
<span class="hljs-comment">//=&gt; &lt;h3&gt;This is the added part&lt;/h3&gt;</span>
el.html(html, <span class="hljs-literal">true</span>);
<span class="hljs-comment">//=&gt; alert(1)</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    html: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(html, loadScripts)</span> </span>{
        <span class="hljs-keyword">return</span> html === <span class="hljs-literal">undefined</span> ?
            <span class="hljs-keyword">this</span>.length ? <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].innerHTML : <span class="hljs-literal">null</span>
            :
            each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                $(el).empty().append(html, loadScripts);
            });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p><strong> .remove() </strong></p>
<ul>
<li><p>.remove()</p>
<p>将符合选择器的所有元素从 DOM 中移除</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    remove: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>移除所有事件绑定</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        self.detach &amp;&amp; self.detach();

        <span class="hljs-keyword">return</span> each(self, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            el.parentNode &amp;&amp; el.parentNode.removeChild(el)
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p><strong> .empty() </strong></p>
<ul>
<li><p>.empty()</p>
<p>清除节点的所有子孙节点</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    empty: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> each(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
            el.innerHTML = <span class="hljs-string">''</span>;
        });
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p><strong> .clone() </strong></p>
<ul>
<li><p>.clone([deep])</p>
<p>获取符合选择器的第一个元素的克隆元素</p>
<p>deep 表示是否深度克隆（克隆节点的子孙节点），默认 false</p>
</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    clone: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(deep)</span> </span>{
        <span class="hljs-keyword">return</span> $(
            map(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
                <span class="hljs-keyword">return</span> el.cloneNode(!!deep);
            })
        );
    }

});

<span class="hljs-comment">/**
 * @ignore
 * @file ie
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>IE10 及以下浏览器不支持 <code>__proto__</code> 继承，需重写 <code>.node()</code> 和 <code>.isNode()</code> 方法来兼容</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> (!(<span class="hljs-string">'__proto__'</span> <span class="hljs-keyword">in</span> {})) {
    mix($, {
        node: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(els)</span> </span>{
            els = els || [];
            mix(els, node);
            els.__node = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">return</span> els;
        },
        isNode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> </span>{
            <span class="hljs-keyword">return</span> isArray(obj) &amp;&amp; <span class="hljs-string">'__node'</span> <span class="hljs-keyword">in</span> obj;
        }
    });
}
<span class="hljs-comment">/**
 * @ignore
 * @file output
 * @author 莫争 &lt;gaoli.gl@taobao.com&gt;
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p><strong> Node 模块提供的快捷方式 </strong></p>
<pre><code>mix(S, {
    node    : node,  <span class="hljs-comment">// 参元类</span>
    Node    : $,     <span class="hljs-comment">// 构造器</span>
    NodeList: $,     <span class="hljs-comment">// 构造器</span>
    one     : $.one, <span class="hljs-comment">// 获取 / 创建一个 Node 对象</span>
    all     : $.all  <span class="hljs-comment">// 获取 / 创建一批 Node 对象</span>
});
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>mix(S, {
    node    : node,
    Node    : $,
    NodeList: $,
    one     : $.one,
    all     : $.all
});

S.add &amp;&amp; S.add(<span class="hljs-string">'node'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(S)</span> </span>{
    <span class="hljs-keyword">return</span> $;
});

}(<span class="hljs-keyword">this</span>, KISSY));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
